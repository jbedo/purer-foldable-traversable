list(
  mapWithIndexArray = function(f) function(xs) lapply(xs, function(x) f(i)(x))
)
